flowchart TB
    subgraph "â˜ï¸ Lenses MCP Platform"
        LENSMCP[("ğŸ”¥ Lenses MCP<br/>financial-data env<br/>14 Topics<br/>11.5M+ Transactions")]
        
        subgraph "ğŸ“Š Kafka Topics"
            CC["ğŸ’³ Credit Card<br/>Transactions<br/>7.2M msgs"]
            PP["ğŸ’° PayPal<br/>Transactions<br/>3.4M msgs"] 
            AL["ğŸš— Auto Loan<br/>Payments<br/>795K msgs"]
            HL["ğŸ  Home Loan<br/>Payments<br/>Messages"]
            RC["ğŸ‘¥ Customers<br/>Reference"]
            RM["ğŸª Merchants<br/>Reference"]
        end
    end
    
    subgraph "ğŸ¤– MerchantIQ System"
        COORD["ğŸ¯ Coordinator Agent<br/>Pipeline Orchestrator"]
        
        subgraph "ğŸ”„ Processing Agents"
            DI["ğŸ“¥ Data Ingestion<br/>Agent"]
            FE["âš™ï¸ Feature Engineering<br/>Agent"] 
            AT["ğŸ“ˆ Attribution<br/>Agent"]
            MS["ğŸ¯ Merchant Scoring<br/>Agent"]
            IN["ğŸ§  Insight<br/>Agent"]
        end
        
        subgraph "ğŸ’¾ Data Layer"
            CACHE["ğŸ“¦ Local Cache<br/>Features & Scores"]
            CONFIG["âš™ï¸ Configuration<br/>lenses_mcp.yaml"]
        end
    end
    
    subgraph "ğŸ–¥ï¸ User Interface"
        DASH["ğŸ“Š Streamlit Dashboard<br/>6 Tabs<br/>Port 8500"]
    end
    
    %% Data Flow
    LENSMCP --> DI
    COORD --> DI
    DI --> FE
    FE --> AT
    AT --> MS
    MS --> IN
    FE --> CACHE
    MS --> CACHE
    IN --> CACHE
    CONFIG --> COORD
    CACHE --> DASH
    COORD --> DASH
    
    %% Styling
    classDef mcpCloud fill:#e1f5fe,stroke:#01579b,stroke-width:3px
    classDef agents fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef data fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef ui fill:#fff3e0,stroke:#e65100,stroke-width:2px
    
    class LENSMCP mcpCloud
    class COORD,DI,FE,AT,MS,IN agents
    class CACHE,CONFIG data
    class DASH ui